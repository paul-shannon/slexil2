<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
    <link rel = "stylesheet" type = "text/css" href = "ijal.css" />
<script src="https://unpkg.com/wavesurfer.js"></script>
<script src="https://unpkg.com/wavesurfer.js/dist/plugin/wavesurfer.regions.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.0.min.js"></script>
<script src="https://unpkg.com/wavesurfer.js/dist/plugin/wavesurfer.timeline.js"></script>
<script src="https://unpkg.com/wavesurfer.js/dist/plugin/wavesurfer.regions.js"></script>
<script src="https://unpkg.com/wavesurfer.js/dist/plugin/wavesurfer.minimap.js"></script>
<link rel = "stylesheet" type = "text/css" href = "ijal.css" />
<link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="showdown.js"></script>
<script src="kb.js"></script>
<script src="https://uicdn.toast.com/editor/latest/toastui-editor-all.min.js"></script>
<link rel="stylesheet" href="https://uicdn.toast.com/editor/latest/toastui-editor.min.css" />

<style>
  #waveform {margin: 10px;
             margin-top: 60px;
             border: 1px black solid;
             border-radius: 10px;
         }
  #controls{margin-bottom: 10px;}
  #controls{margin-top: 30px;}
  .row{margin-bottom: 30px;}

  #textDiv{
     overflow-y: scroll;
     width: 90%;
     height: 800px;
     }

  div.spokenLine{
     border: 1px solid lightgray;
     background-color: lightyellow;
     border-radius: 10px;
     }
  div.currentLine{
      border: 2px solid red;
      border-radius: 10px;
      }

  .highlight{
     background-color: lightgray;
     }

  #linesDiv{
      //border: 1px solid black;
      padding: 15px;
      margin: 5px;
      height: 60%;
      overflow-y: scroll;
      }

  .card {display:inline-block;}

  div.annotationDiv{
     background-color: white;
     margin: 30px;
     padding: 10px;
     border: 1px solid black;
     border-radius: 10px;
     height: 300px;
     width: 800px;
     overflow-y: auto;
     overflow-wrap: normal;
     //inline-size: 600px;
     //overflow-wrap: anywhere;
     display: none;
     }

</style>

  </head>
  <body>
<div id="main" class="container">
  <div class="row" id="waveform-div">
    <div id="controls" class="col-md-6">
      <div class="card">
        <div class="card-body">  
	  <button class="btn btn-outline-primary" onclick='play()' >PLAY</button>
	  <button class="btn btn-outline-primary" onclick='pause()'>Pause</button>
	  <div style="margin-top: 10px; margin-bottom: 10px;">
            <button id="resetButton" class="btn btn-outline-primary" onclick='reset()'
                    data-bs-toggle="tooltip" data-bs-placement="top"
                    title="Remove any regions, go to start, use normal playback speed."
                    >Reset</button>
            <div class="btn-group">
              <button type="button" class="btn btn-outline-primary dropdown-toggle"
                      data-bs-toggle="dropdown" aria-expanded="false"> Speed </button>
              <ul class="dropdown-menu">
		<li><a class="dropdown-item" onclick="halfSpeed()">Half</a></li>
		<li><a class="dropdown-item" onclick="threeQuarterSpeed()">Three quarters</a></li>
		<li><a class="dropdown-item" onclick="normalSpeed()">Normal</a></li>
              </ul>
            </div>
	  </div>
	  </div>
      </div>

      <div class="card">
        <div class="card-body">  
          <h6 class="card-title">Tier Visibility</h6>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="speechTier" onclick="speechTierToggle()" checked>
            <label class="form-check-label" for="flexCheckDefault"> Speech </label>
          </div>
          
          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="morphemeTier" onclick="morphemeTierToggle()" checked>
            <label class="form-check-label" for="flexCheckChecked"> Morpheme </label>
          </div>

	  <div class="form-check">
	    <input class="form-check-input" type="checkbox" value="" id="morphemeGloss" onclick="morphemeGlossTierToggle()" checked>
	    <label class="form-check-label" for="flexCheckChecked"> Morpheme Gloss</label>
	  </div>

	  <div class="form-check">
	    <input class="form-check-input" type="checkbox" value="" id="morphemeTier" onclick="translationTierToggle()" checked>
	    <label class="form-check-label" for="flexCheckChecked"> Translation </label>
	  </div>

	  <div class="form-check">
	    <input class="form-check-input" type="checkbox" value="" id="annotations" onclick="annotationsToggle()">
	    <label class="form-check-label" for="flexCheckChecked"> Annotations </label>
	  </div>
        </div>
      </div>
      </div>


    <div class="col-md-6">
      <div id="waveform"></div>
    </div>

  </div id="waveform-div">

    </div id="row">

    <div id="textDiv">
      <div class="line-wrapper" id="1">
        <div class="line-sidebar">1)<audio id="a1"><source src="audio/a1.wav"/></audio><button onclick="playSample('a1')">üîà</button></div>
        <div class="line-content" id="1">
          <div class="line">
            <div class="speech-tier">tudx ∑adhad…ôx ∑ ti î…ô î  îaci…¨talbix ∑.   î…ôscÃåal…ôx ∑ k ∑i g ∑…ôd…ôx ∑k ∑…ôdx ∑ cÃå…ô…¨ k ∑i sl…ôxÃåil.</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 26ch 6ch 13ch 13ch 4ch 18ch 7ch 4ch 9ch ;">
            <div class="morpheme-cell">tu=dx ∑‚Äìhad‚Äìhad=…ôx ∑</div>
            <div class="morpheme-cell">ti î…ô î</div>
            <div class="morpheme-cell"> îaci…¨talbix ∑</div>
            <div class="morpheme-cell"> î…ôs‚ÄìcÃåal=…ôx ∑</div>
            <div class="morpheme-cell">k ∑i</div>
            <div class="morpheme-cell">g ∑…ô=d…ôx ∑=k ∑…ôd‚Äìdx ∑</div>
            <div class="morpheme-cell">cÃå…ô…¨</div>
            <div class="morpheme-cell">k ∑i</div>
            <div class="morpheme-cell">sl…ôxÃåil</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 26ch 6ch 13ch 13ch 4ch 18ch 7ch 4ch 9ch ;">
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">past</span>=<span class="grammatical-term">ctd</span>‚Äì<span class="grammatical-term">dstr</span>‚Äìdiscuss=now</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">prox</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">people</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">stat</span>‚Äìhow=now</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">rem</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">sbj</span>=<span class="grammatical-term">adnm</span>=take‚Äì<span class="grammatical-term">dc</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">1pl</span>.<span class="grammatical-term">po</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">rem</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">daylight</div>
            </div>
          </div>
          <div class="freeTranslation-tier">The people talked it over. How can we manage to obtain the daylight?</div>
          <div class="annotationDiv"></div>
        </div>
      </div>
      <div class="line-wrapper" id="2">
        <div class="line-sidebar">2)<audio id="a2"><source src="audio/a2.wav"/></audio><button onclick="playSample('a2')">üîà</button></div>
        <div class="line-content" id="2">
          <div class="line">
            <div class="speech-tier"> îa î k ∑i sl…ôxÃåil  îal k ∑i q‚Äôx ∑ul‚Äôg ∑…ôdx ∑ g ∑…ôl  î…ôscÃåal k ∑i g ∑…ôd…ôx ∑k ∑…ôdx ∑ cÃå…ô…¨</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 9ch 4ch 9ch 4ch 4ch 15ch 6ch 9ch 4ch 18ch 7ch ;">
            <div class="morpheme-cell"> îa î</div>
            <div class="morpheme-cell">k ∑i</div>
            <div class="morpheme-cell">sl…ôxÃåil</div>
            <div class="morpheme-cell"> îal</div>
            <div class="morpheme-cell">k ∑i</div>
            <div class="morpheme-cell">q‚Äôx ∑‚Ä¢ul‚Äôg ∑…ôdx ∑</div>
            <div class="morpheme-cell">g ∑…ôl</div>
            <div class="morpheme-cell"> î…ôs‚ÄìcÃåal</div>
            <div class="morpheme-cell">k ∑i</div>
            <div class="morpheme-cell">g ∑…ô=d…ôx ∑=k ∑…ôd‚Äìdx ∑</div>
            <div class="morpheme-cell">cÃå…ô…¨</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 9ch 4ch 9ch 4ch 4ch 15ch 6ch 9ch 4ch 18ch 7ch ;">
            <div class="morpheme-cell">
              <div class="morpheme-gloss">be.there</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">rem</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">daylight</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">at</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">rem</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">upstream‚Ä¢land</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">sconj</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">stat</span>‚Äìhow</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">rem</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">sbj</span>=<span class="grammatical-term">adnm</span>=take‚Äì<span class="grammatical-term">dc</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">1pl</span>.<span class="grammatical-term">po</span></div>
            </div>
          </div>
          <div class="freeTranslation-tier">Daylight is up there in the upriver country but how can we manage to get it?</div>
          <div class="annotationDiv"></div>
        </div>
      </div>
      <div class="line-wrapper" id="3">
        <div class="line-sidebar">3)<audio id="a3"><source src="audio/a3.wav"/></audio><button onclick="playSample('a3')">üîà</button></div>
        <div class="line-content" id="3">
          <div class="line">
            <div class="speech-tier">si î…ôx ∑ cÃå…ô…¨ ∆õ‚Äôub…ôx ∑ dx ∑ îal k ∑i g ∑…ôsu îuxÃå ∑c cÃå…ô…¨ k ∑i sl…ôxÃåil  îal k ∑i d…ôx ∑ îac…ôc</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 9ch 8ch 9ch 10ch 4ch 19ch 7ch 4ch 9ch 4ch 4ch 17ch ;">
            <div class="morpheme-cell">si î=…ôx ∑</div>
            <div class="morpheme-cell">cÃå…ô…¨</div>
            <div class="morpheme-cell">∆õ‚Äôub=…ôx ∑</div>
            <div class="morpheme-cell">dx ∑‚Äì îal</div>
            <div class="morpheme-cell">k ∑i</div>
            <div class="morpheme-cell">g ∑…ô=s= îu‚Äì îuxÃå ∑‚Äìc</div>
            <div class="morpheme-cell">cÃå…ô…¨</div>
            <div class="morpheme-cell">k ∑i</div>
            <div class="morpheme-cell">sl…ôxÃåil</div>
            <div class="morpheme-cell"> îal</div>
            <div class="morpheme-cell">k ∑i</div>
            <div class="morpheme-cell">d…ôx ∑= îac…ôc</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 9ch 8ch 9ch 10ch 4ch 19ch 7ch 4ch 9ch 4ch 4ch 17ch ;">
            <div class="morpheme-cell">
              <div class="morpheme-gloss">here=now</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">1pl</span>.<span class="grammatical-term">sub</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">well=now</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">cntrpt</span>‚Äìat</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">rem</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">sbj</span>=<span class="grammatical-term">nm</span>=<span class="grammatical-term">pfv</span>‚Äìgo‚Äì<span class="grammatical-term">altv</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">1pl</span>.<span class="grammatical-term">po</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">rem</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">daylight</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">at</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">rem</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">adnm</span>=be.in.place</div>
            </div>
          </div>
          <div class="freeTranslation-tier">We are good enough to go after daylight where it is.</div>
          <div class="annotationDiv"></div>
        </div>
      </div>
      <div class="line-wrapper" id="4">
        <div class="line-sidebar">4)<audio id="a4"><source src="audio/a4.wav"/></audio><button onclick="playSample('a4')">üîà</button></div>
        <div class="line-content" id="4">
          <div class="line">
            <div class="speech-tier">(21) tus…ôg ∑a îx ∑  îuxÃå ∑ tuxÃå ∑ x ∑i î u îx ∑ k ∑i sl…ôxÃåil tuxÃå ∑ x ∑i î u îx ∑ q‚Äôx ∑ul‚Äôg ∑…ôdx ∑</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 15ch 6ch 6ch 5ch 5ch 4ch 9ch 6ch 5ch 5ch 14ch ;">
            <div class="morpheme-cell">tu=s…ô‚Äìg ∑a îx ∑</div>
            <div class="morpheme-cell"> îuxÃå ∑</div>
            <div class="morpheme-cell">tuxÃå ∑</div>
            <div class="morpheme-cell">x ∑i î</div>
            <div class="morpheme-cell">u îx ∑</div>
            <div class="morpheme-cell">k ∑i</div>
            <div class="morpheme-cell">sl…ôxÃåil</div>
            <div class="morpheme-cell">tuxÃå ∑</div>
            <div class="morpheme-cell">x ∑i î</div>
            <div class="morpheme-cell">u îx ∑</div>
            <div class="morpheme-cell">q‚Äôx ∑ul‚Äôg ∑…ôdx ∑</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 15ch 6ch 6ch 5ch 5ch 4ch 9ch 6ch 5ch 5ch 14ch ;">
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">past</span>=<span class="grammatical-term">prog</span>‚Äìwalk</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">go</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">but</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">not</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">yet</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">rem</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">daylight</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">but</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">not</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">yet</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">upstream‚Ä¢land</div>
            </div>
          </div>
          <div class="freeTranslation-tier">They sought for daylight in the land upstream.</div>
          <div class="annotationDiv"></div>
        </div>
      </div>
      <div class="line-wrapper" id="5">
        <div class="line-sidebar">5)<audio id="a5"><source src="audio/a5.wav"/></audio><button onclick="playSample('a5')">üîà</button></div>
        <div class="line-content" id="5">
          <div class="line">
            <div class="speech-tier">(22) xÃå ∑ul‚Äô…ôx ∑ …ôlg ∑…ô î tul…ôcÃå‚Äôitil dx ∑ îal ti î…ô î d…ôx ∑ îa  î…ô k ∑i sl…ôxÃåil l…ôxÃåilicÃå…ôx ∑ …ôlg ∑…ô î</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 11ch 7ch 20ch 10ch 6ch 14ch 3ch 4ch 9ch 24ch 7ch ;">
            <div class="morpheme-cell">xÃå ∑ul‚Äô=…ôx ∑</div>
            <div class="morpheme-cell">…ôlg ∑…ô î</div>
            <div class="morpheme-cell">tu=l…ô=cÃå‚Äôit‚Äìil</div>
            <div class="morpheme-cell">dx ∑‚Äì îal</div>
            <div class="morpheme-cell">ti î…ô î</div>
            <div class="morpheme-cell">d…ôx ∑ îa</div>
            <div class="morpheme-cell"> î…ô</div>
            <div class="morpheme-cell">k ∑i</div>
            <div class="morpheme-cell">sl…ôxÃåil</div>
            <div class="morpheme-cell">l…ôxÃå‚Äìil‚Ä¢icÃå=…ôx ∑</div>
            <div class="morpheme-cell">…ôlg ∑…ô î</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 11ch 7ch 20ch 10ch 6ch 14ch 3ch 4ch 9ch 24ch 7ch ;">
            <div class="morpheme-cell">
              <div class="morpheme-gloss">only=now</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">pl</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">past</span>=<span class="grammatical-term">prog</span>=near‚Äì<span class="grammatical-term">inch</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">cntrpt</span>‚Äìat</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">prox</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">adnm</span>=be.there</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">pr</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">rem</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">daylight</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">light‚Äì<span class="grammatical-term">inch</span>‚Ä¢covering=now</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">pl</span>
              </div>
            </div>
          </div>
          <div class="freeTranslation-tier">As they drew near this place of daylight, light enveloped them.</div>
          <div class="annotationDiv"></div>
        </div>
      </div>
      <div class="line-wrapper" id="6">
        <div class="line-sidebar">6)<audio id="a6"><source src="audio/a6.wav"/></audio><button onclick="playSample('a6')">üîà</button></div>
        <div class="line-content" id="6">
          <div class="line">
            <div class="speech-tier">(28)-(29) …¨udx ∑ îiw…ôd…ôx ∑ …ôlg ∑…ô î g ∑at…ôx ∑  î…ô dib…ô…¨ k ∑i …¨u îuxÃå ∑tx ∑ k ∑i sl…ôxÃåil</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 19ch 7ch 9ch 3ch 6ch 4ch 13ch 4ch 9ch ;">
            <div class="morpheme-cell">…¨u=dx ∑‚Äì îiw…ôd=…ôx ∑</div>
            <div class="morpheme-cell">…ôlg ∑…ô î</div>
            <div class="morpheme-cell">g ∑at=…ôx ∑</div>
            <div class="morpheme-cell"> î…ô</div>
            <div class="morpheme-cell">dib…ô…¨</div>
            <div class="morpheme-cell">k ∑i</div>
            <div class="morpheme-cell">…¨u= îuxÃå ∑‚Äìtx ∑</div>
            <div class="morpheme-cell">k ∑i</div>
            <div class="morpheme-cell">sl…ôxÃåil</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 19ch 7ch 9ch 3ch 6ch 4ch 13ch 4ch 9ch ;">
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">irr</span>=<span class="grammatical-term">ctd</span>‚Äìdecide=now</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">pl</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">who=now</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">pr</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">we</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">rem</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">irr</span>=go‚Äì<span class="grammatical-term">ecs</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">rem</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">daylight</div>
            </div>
          </div>
          <div class="freeTranslation-tier">They will decide.  Which of us will take the light?</div>
          <div class="annotationDiv"></div>
        </div>
      </div>
      <div class="line-wrapper" id="7">
        <div class="line-sidebar">7)<audio id="a7"><source src="audio/a7.wav"/></audio><button onclick="playSample('a7')">üîà</button></div>
        <div class="line-content" id="7">
          <div class="line">
            <div class="speech-tier">(30)-(31) g ∑…ôsduk ∑ g ∑…ôb…ôk‚Äô ∑a…¨i g ∑…ô îuxÃå ∑ y…ôxÃåi cÃå…ô…¨ g ∑…ôhaydub l…ô îuxÃå ∑c cÃå…ô…¨ ti î…ô î sl…ôxÃåil</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 15ch 16ch 10ch 8ch 8ch 18ch 13ch 8ch 6ch 9ch ;">
            <div class="morpheme-cell">g ∑…ô=s=duk ∑</div>
            <div class="morpheme-cell">g ∑…ô=b…ôk‚Äô ∑=a…¨i</div>
            <div class="morpheme-cell">g ∑…ô= îuxÃå ∑</div>
            <div class="morpheme-cell">y…ôxÃåi</div>
            <div class="morpheme-cell">cÃå…ô…¨</div>
            <div class="morpheme-cell">g ∑…ô=hay‚Äìdx ∑‚Äìb</div>
            <div class="morpheme-cell">l…ô= îuxÃå ∑‚Äìc</div>
            <div class="morpheme-cell">cÃå…ô…¨</div>
            <div class="morpheme-cell">ti î…ô î</div>
            <div class="morpheme-cell">sl…ôxÃåil</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 15ch 16ch 10ch 8ch 8ch 18ch 13ch 8ch 6ch 9ch ;">
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">sbj</span>=<span class="grammatical-term">nm</span>=anormal</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">sbj</span>=all=<span class="grammatical-term">1pl</span>.<span class="grammatical-term">sbj</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">sbj</span>=go</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">because</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">1pl</span>.<span class="grammatical-term">sub</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">sbj</span>=known‚Äì<span class="grammatical-term">dc</span>‚Äì<span class="grammatical-term">pass</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">prog</span>=go‚Äì<span class="grammatical-term">altv</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">1pl</span>.<span class="grammatical-term">sub</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">prox</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">daylight</div>
            </div>
          </div>
          <div class="freeTranslation-tier">It would be bad if we both were to go, because we would be known to be going after this light.</div>
          <div class="annotationDiv"></div>
        </div>
      </div>
      <div class="line-wrapper" id="8">
        <div class="line-sidebar">8)<audio id="a8"><source src="audio/a8.wav"/></audio><button onclick="playSample('a8')">üîà</button></div>
        <div class="line-content" id="8">
          <div class="line">
            <div class="speech-tier">(32) …¨uqadabid cÃå…ô…¨  îal k ∑i …¨ud…ôx ∑ îac…ôc</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 17ch 8ch 4ch 4ch 21ch ;">
            <div class="morpheme-cell">…¨u=qada‚Äìbi‚Äìd</div>
            <div class="morpheme-cell">cÃå…ô…¨</div>
            <div class="morpheme-cell"> îal</div>
            <div class="morpheme-cell">k ∑i</div>
            <div class="morpheme-cell">…¨u=d…ôx ∑= îac…ôc</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 17ch 8ch 4ch 4ch 21ch ;">
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">irr</span>=steal‚Äì<span class="grammatical-term">ss</span>‚Äì<span class="grammatical-term">ics</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">1pl</span>.<span class="grammatical-term">sub</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">at</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">rem</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">irr</span>=<span class="grammatical-term">adnm</span>=be.in.place</div>
            </div>
          </div>
          <div class="freeTranslation-tier">We will steal it from where it is.</div>
          <div class="annotationDiv"></div>
        </div>
      </div>
      <div class="line-wrapper" id="9">
        <div class="line-sidebar">9)<audio id="a9"><source src="audio/a9.wav"/></audio><button onclick="playSample('a9')">üîà</button></div>
        <div class="line-content" id="9">
          <div class="line">
            <div class="speech-tier">(66)  îal…ôx ∑ s…¨ix ∑…ô…¨dacuts k ∑i s îa îs bib≈°ƒç…ôb g ∑…ôl  îuxÃå ∑c ti î…ô î sl…ôxÃåil</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 8ch 30ch 4ch 16ch 10ch 6ch 8ch 6ch 9ch ;">
            <div class="morpheme-cell"> îal=…ôx ∑</div>
            <div class="morpheme-cell">s=…¨ix ∑‚Ä¢…ô…¨‚Ä¢dat‚Äìt‚Äìsut=s</div>
            <div class="morpheme-cell">k ∑i</div>
            <div class="morpheme-cell">s= îa î=s</div>
            <div class="morpheme-cell">bi‚Äìb…ô≈°ƒç…ôb</div>
            <div class="morpheme-cell">g ∑…ôl</div>
            <div class="morpheme-cell"> îuxÃå ∑‚Äìc</div>
            <div class="morpheme-cell">ti î…ô î</div>
            <div class="morpheme-cell">sl…ôxÃåil</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 8ch 30ch 4ch 16ch 10ch 6ch 8ch 6ch 9ch ;">
            <div class="morpheme-cell">
              <div class="morpheme-gloss">at=now</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">nm</span>=three‚Ä¢<span class="grammatical-term">cls</span>‚Ä¢day‚Äì<span class="grammatical-term">ics</span>‚Äì<span class="grammatical-term">refl</span>=<span class="grammatical-term">3po</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">rem</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">nm</span>=be.there=<span class="grammatical-term">3po</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">attn</span>‚Äìmink</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">sconj</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">go‚Äì<span class="grammatical-term">altv</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">prox</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">daylight</div>
            </div>
          </div>
          <div class="freeTranslation-tier">When it was three days that Little Mink was there, then he went after the daylight.</div>
          <div class="annotationDiv"></div>
        </div>
      </div>
      <div class="line-wrapper" id="10">
        <div class="line-sidebar">10)<audio id="a10"><source src="audio/a10.wav"/></audio><button onclick="playSample('a10')">üîà</button></div>
        <div class="line-content" id="10">
          <div class="line">
            <div class="speech-tier">(67) x ∑i î u îx ∑ g ∑…ôs…¨a î  î…ô ti î…ô î ƒçal…ôs</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 5ch 5ch 14ch 3ch 6ch 9ch ;">
            <div class="morpheme-cell">x ∑i î</div>
            <div class="morpheme-cell">u îx ∑</div>
            <div class="morpheme-cell">g ∑…ô=s=…¨a î</div>
            <div class="morpheme-cell"> î…ô</div>
            <div class="morpheme-cell">ti î…ô î</div>
            <div class="morpheme-cell">ƒçal…ôs‚Äìs</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 5ch 5ch 14ch 3ch 6ch 9ch ;">
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">neg</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">ptcl</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">sbj</span>=<span class="grammatical-term">nm</span>=arrive</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">pr</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">prox</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">hand‚Äì<span class="grammatical-term">3po</span></div>
            </div>
          </div>
          <div class="freeTranslation-tier">He can not reach it with his hand.</div>
          <div class="annotationDiv"></div>
        </div>
      </div>
      <div class="line-wrapper" id="11">
        <div class="line-sidebar">11)<audio id="a11"><source src="audio/a11.wav"/></audio><button onclick="playSample('a11')">üîà</button></div>
        <div class="line-content" id="11">
          <div class="line">
            <div class="speech-tier">(68) ∆õ‚Äôal‚Äô lil gw…ôl l…ôxÃå</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 6ch 4ch 6ch 6ch ;">
            <div class="morpheme-cell">∆õ‚Äôal‚Äô</div>
            <div class="morpheme-cell">lil</div>
            <div class="morpheme-cell">gw…ôl</div>
            <div class="morpheme-cell">l…ôxÃå</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 6ch 4ch 6ch 6ch ;">
            <div class="morpheme-cell">
              <div class="morpheme-gloss">also</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">far</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">sconj</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">light</div>
            </div>
          </div>
          <div class="freeTranslation-tier">It was still far away when it lit up.</div>
          <div class="annotationDiv"></div>
        </div>
      </div>
      <div class="line-wrapper" id="12">
        <div class="line-sidebar">12)<audio id="a12"><source src="audio/a12.wav"/></audio><button onclick="playSample('a12')">üîà</button></div>
        <div class="line-content" id="12">
          <div class="line">
            <div class="speech-tier">(77) di…¨ tusp…ôk ∑ibids ti î…ô î sl…ôxÃåil g ∑…ôl tusax ∑…ôbtx ∑</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 4ch 27ch 6ch 9ch 6ch 14ch ;">
            <div class="morpheme-cell">di…¨</div>
            <div class="morpheme-cell">tu=s=p…ôk ∑ib‚Äìbi‚Äìd=s</div>
            <div class="morpheme-cell">ti î…ô î</div>
            <div class="morpheme-cell">sl…ôxÃåil</div>
            <div class="morpheme-cell">g ∑…ôl</div>
            <div class="morpheme-cell">tu=sax ∑…ôb‚Äìtx ∑</div>
          </div>
          <div class="morpheme-tier" style="grid-template-columns: 4ch 27ch 6ch 9ch 6ch 14ch ;">
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">loc</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">past</span>=<span class="grammatical-term">nm</span>=snatch‚Äì<span class="grammatical-term">map</span>‚Äì<span class="grammatical-term">ics</span>=<span class="grammatical-term">3po</span></div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">prox</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">daylight</div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss">
                <span class="grammatical-term">sconj</span>
              </div>
            </div>
            <div class="morpheme-cell">
              <div class="morpheme-gloss"><span class="grammatical-term">past</span>=jump‚Äì<span class="grammatical-term">ecs</span></div>
            </div>
          </div>
          <div class="freeTranslation-tier">He snatched the daylight and ran off with it.</div>
          <div class="annotationDiv"></div>
        </div>
      </div>
    </div>
    <div class="spacer"></div>
    <script src="ijalUtils.js"></script>
    <script type="text/javascript">window.timeStamps=[{ 'id' : '1', 'start' : 12336, 'end' : 17777},
{ 'id' : '2', 'start' : 17777, 'end' : 23895},
{ 'id' : '3', 'start' : 88075, 'end' : 93611},
{ 'id' : '4', 'start' : 105180, 'end' : 108783},
{ 'id' : '5', 'start' : 111638, 'end' : 119617},
{ 'id' : '6', 'start' : 144827, 'end' : 149367},
{ 'id' : '7', 'start' : 149278, 'end' : 154705},
{ 'id' : '8', 'start' : 154750, 'end' : 157690},
{ 'id' : '9', 'start' : 283259, 'end' : 289790},
{ 'id' : '10', 'start' : 288246, 'end' : 292518},
{ 'id' : '11', 'start' : 292453, 'end' : 294115},
{ 'id' : '12', 'start' : 332187, 'end' : 336189},]</script>
</div>              

<script>
  var wavesurfer;
  var converter = new showdown.Converter();    // converts markdown to html
  var tierVisibility = {speech: true,
                        morphemes: true,
                        morphemeGloss: true,
                        translation: true,
                        annotations: false};

  var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
  var divSounds = {"line.001":"a1.wav", "line.002":"a2.wav",
                   "line.003":"a3.wav", "line.004": "a4.wav"}
  var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
      return new bootstrap.Tooltip(tooltipTriggerEl, {
          container: 'body',
          trigger: 'hover'})});

  //-------------------------------------------------------------------------
  $(document).ready(function() {
     wavesurfer = WaveSurfer.create({
        container: '#waveform',
        responsive: true,
        waveColor: 'gray',
        height: "200",
        progressColor: 'purple',
        plugins: [
            WaveSurfer.regions.create({
                regionsMinLength: 0.001,
                regions: []
            })
            ]
         });
      wavesurfer.on("ready", function(){
         console.log("wavesurfer ready")
         wavesurfer.enableDragSelection({minLength:0.0,
                                         maxLength:10});
      });


      wavesurfer.on('region-updated', function(region){
         var regions = region.wavesurfer.regions.list;
         var keys = Object.keys(regions);
         if(keys.length > 1){
           regions[keys[0]].remove();
           }
         });



    wavesurfer.load('audio/a1.wav');
    window.wavesurfer = wavesurfer;

    installCurrentLineHandlers();

    $("div.line-content").on("click", function(e){
       console.log("--- div.line-content clicked");
       var currentLine = this;
       var lineID = currentLine.closest(".line-wrapper").getAttribute("id")
       var rowDivs = $("div.line-content")
       var rowID = $(this).attr("id");
       rowDivs.each(function(index){$(this).removeClass("currentLine");})
       $(this).addClass("currentLine")
       installCurrentLineHandlers()
       //if(Object.keys(divSounds).indexOf(rowID) >= 0){
       soundFile = "audio/a" +  lineID + ".wav";
       var url = "http://localhost:8123/" + soundFile;
       wavesurfer.load(soundFile);
        //  } // if sound
       if(tierVisibility["annotations"]) {
          $("div.line-content > div.annotationDiv").hide();
          $("div.line-content.currentLine> div.annotationDiv").show();
          }
        });

  });  // document ready
  //-------------------------------------------------------------------------
  function installCurrentLineHandlers(){
    $(".grammatical-term, .morpheme-cell, .speech-tier").unbind("mouseenter mouseleave")
    //$(".currentLine").find(".grammatical-term, .lushootseed-morpheme, .speech-tier")
    $(".currentLine").find(".grammatical-term, .morpheme-cell, .speech-tier")
      .mouseenter(function(e){
         $(this).addClass("highlight");
         var key = this.innerHTML
         console.log("  mouseenter: " + key)
         if(tierVisibility["annotations"]){
            var htmlText = "<button class='btn btn-outline-primary'>Edit</button> &nbsp; &nbsp;";
            htmlText += "<b>" + key + "</b><p>";
            htmlText += lookup(key);
            $("div.line-content > div.annotationDiv").html(htmlText);
            }
         })
      .mouseleave(function(e){
         $(this).removeClass("highlight");
         });
     }; // installCurrentLineHandlers

  function speechTierToggle(){
     tierName = 'speech'
     tierVisibility[tierName] = !tierVisibility[tierName];
     console.log("speech tier? " + tierVisibility[tierName]);
     if(!tierVisibility[tierName]){
         $(".speech-tier").hide();
         }
      else{
          $(".speech-tier").show()
          }
     }; // speechTierToggle

  function morphemeTierToggle(){
     tierName = 'morphemes'
     tierVisibility[tierName] = !tierVisibility[tierName];
     console.log("morphemes tier? " + tierVisibility[tierName]);
     if(!tierVisibility[tierName]){
         $(".morpheme-cell.lushootseed-morpheme").hide();
         }
      else{
          $(".morpheme-cell.lushootseed-morpheme").show()
          }
     };

  function morphemeGlossTierToggle(){
     tierName = 'morphemeGloss'
     tierVisibility[tierName] = !tierVisibility[tierName];
     console.log("morphemeGloss tier? " + tierVisibility[tierName]);
     if(!tierVisibility[tierName]){
         $(".morpheme-gloss").hide();
         }
      else{
          $(".morpheme-gloss").show()
          }
      };

  function translationTierToggle(){
     tierName = 'translation'
     tierVisibility[tierName] = !tierVisibility[tierName];
     console.log("translation tier? " + tierVisibility[tierName]);
     if(!tierVisibility[tierName]){
         $(".freeTranslation-tier").hide();
         }
      else{
          $(".freeTranslation-tier").show()
          }
      };

  function annotationsToggle(){
     tierName = 'annotations'
     tierVisibility[tierName] = !tierVisibility[tierName];
     console.log("annotations tier? " + tierVisibility[tierName]);
     //$("div.line-content").on("click", function(e){
     //$("div.line-content.currentLine > div.annotationDiv").empty().show()
     $("div.line-content > div.annotationDiv").hide();
     if(tierVisibility[tierName]){
         $("div.line-content.currentLine > div.annotationDiv").empty().show();
        installCurrentLineHandlers();
        }
     }; // annotationsToggle


  function pauseSound(){console.log("pausing");
                        wavesurfer.pause();
                       }
  function clearRegions(){wavesurfer.clearRegions();}

  function quarterSpeed(){wavesurfer.setPlaybackRate(0.25);}
  function halfSpeed(){wavesurfer.setPlaybackRate(0.50);}
  function threeQuarterSpeed(){wavesurfer.setPlaybackRate(0.75);}
  function normalSpeed(){wavesurfer.setPlaybackRate(1.0);}

  function continuePlay(){
     var keys = Object.keys(wavesurfer.regions.list)
     var currentTime = wavesurfer.getCurrentTime();
     if(keys.length == 0){
         wavesurfer.play(currentTime)
         }
     if(keys.length > 0){
        var currentRegion = wavesurfer.regions.list[keys[0]];
        console.log("  contineuSound, current time: " + currentTime)
        wavesurfer.play(currentTime, currentRegion.end);
        }
     } // continue

  function play(){
     var currentTime = wavesurfer.getCurrentTime()
     console.log(" --- play, currentTime: " + currentTime)      
     var keys = Object.keys(wavesurfer.regions.list)
     if(keys.length == 0){
         wavesurfer.play();
        }
     if(keys.length > 0){
        var currentRegion = wavesurfer.regions.list[keys[0]];
        var currentTime = wavesurfer.getCurrentTime();
        console.log("  play,  current time: " + currentTime)
        currentRegion.play()
        }
     } // play

  function reset(){
    $("#resetButton").tooltip('hide')
     wavesurfer.clearRegions()
     wavesurfer.setCurrentTime(0);
     normalSpeed();
     }
  
  function pause(){
     var keys = Object.keys(wavesurfer.regions.list)
      if(keys.length == 0){
         wavesurfer.pause()
         }
     if(keys.length > 0){
        var currentRegion = wavesurfer.regions.list[keys[0]];
        var currentTime = wavesurfer.getCurrentTime();
        console.log("  pause,  current time: " + currentTime)
        wavesurfer.pause()
        }
     } // playCurrentSelection

  function lookup(morpheme){
    var found = Object.keys(kb).indexOf(morpheme) >= 0;
    console.log("---- lookup, using kb: '" + morpheme + "', found? " + found);
    if(Object.keys(kb).indexOf(morpheme) < 0)
       return("");
    var markup = converter.makeHtml(kb[morpheme]);
    return(markup);
    } // lookup

  function annoEditor(existingMarkup){
    console.log("--- launch editor")
    const editor = new toastui.Editor({
        el: document.querySelector('#editor'),
        initialValue: existingMarkup
        }) 
    } // annoEditor


//------------------------------------------------------------------------------------------------------------------------
</script>
  </body>
</html>